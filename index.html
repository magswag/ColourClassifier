<!DOCTYPE html>
<html>

<head>
    <title>Colours</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0/dist/tf.min.js"></script>
</head>
<style>
    .card {
        overflow: hidden;
        border-radius: 24px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
        background-color: white;
    }

    .card .content {
        padding: 16px;
        vertical-align: middle;
    }

    #colourSquare {
        background-color: blue;
        width: 100%;
        height: 100px;
    }

    body {
        margin: 16px;
    }
</style>

<body>
    <script>
        const labels = [
            "Black",
            "Blue",
            "Brown",
            "Green",
            "Grey",
            "Orange",
            "Pink",
            "Purple",
            "Red",
            "White",
            "Yellow"
        ]

        var model
        async function loadModel() {
            model = await tf.loadLayersModel('https://raw.githubusercontent.com/magswag/ColourClassifier/main/model.json')
        }

        class L2 {

            static className = 'L2';

            constructor(config) {
                return tf.regularizers.l1l2(config)
            }
        }
        tf.serialization.registerClass(L2);

        loadModel()


        function onChanged() {
            let r = document.getElementById("r").value
            let g = document.getElementById("g").value
            let b = document.getElementById("b").value

            document.getElementById("colourSquare").style.backgroundColor = "rgb(" + r.toString() + "," + g.toString() + "," + b.toString() + ")"
            let prediction = model.predict(tf.tensor2d([[r / 255, g / 255, b / 255]]))
            //prediction.argMax(1).print()
            //prediction.print()

            document.getElementById("pred").innerHTML = labels[prediction.argMax(1).dataSync()[0]]
        }
    </script>
    <div class="card">
        <div id="colourSquare"></div>
        <div class="content">
            <input type="range" min="0" max="255" value="0" oninput="onChanged()" id="r">
            <input type="range" min="0" max="255" value="0" oninput="onChanged()" id="g">
            <input type="range" min="0" max="255" value="0" oninput="onChanged()" id="b">
            <p id="pred">Blue</p>
        </div>
    </div>
</body>

</html>